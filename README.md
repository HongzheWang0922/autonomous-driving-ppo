# Autonomous Driving with PPO

åŸºäºå¼ºåŒ–å­¦ä¹ (PPO)çš„è‡ªåŠ¨é©¾é©¶é¡¹ç›®

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

ä½¿ç”¨ Proximal Policy Optimization (PPO) ç®—æ³•è®­ç»ƒè‡ªåŠ¨é©¾é©¶Agentåœ¨äº¤å‰è·¯å£ç¯å¢ƒä¸­å®‰å…¨é©¾é©¶ã€‚

### ä¸»è¦æˆæœ
- âœ… **Stage 1**: å•è·¯å£ï¼Œ5è¾†è½¦ï¼Œ**83%æˆåŠŸç‡**
- ğŸ† ç¨³å®šçš„è®­ç»ƒæµç¨‹
- ğŸ“Š å®Œæ•´çš„è¯„ä¼°å’Œå¯è§†åŒ–å·¥å…·

## ğŸ“ é¡¹ç›®ç»“æ„

```
autonomous-driving-ppo/
â”œâ”€â”€ envs/                    # ç¯å¢ƒå®šä¹‰
â”‚   â”œâ”€â”€ intersection_env.py # äº¤å‰è·¯å£ç¯å¢ƒ
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ agents/                  # Agentç›¸å…³
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ utils/                   # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ callbacks.py        # è®­ç»ƒå›è°ƒ
â”‚   â”œâ”€â”€ reward_logger.py    # å¥–åŠ±è®°å½•
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ scripts/                 # è®­ç»ƒ/è¯„ä¼°è„šæœ¬
â”‚   â”œâ”€â”€ train_multistage.py    # å¤šé˜¶æ®µè®­ç»ƒ
â”‚   â”œâ”€â”€ evaluate_local.py      # è¯„ä¼°è„šæœ¬
â”‚   â”œâ”€â”€ visualize_local.py     # å¯è§†åŒ–è„šæœ¬
â”‚   â””â”€â”€ verify_fix.py          # éªŒè¯è„šæœ¬
â”œâ”€â”€ outputs/                 # è¾“å‡ºæ–‡ä»¶
â”‚   â”œâ”€â”€ models/             # è®­ç»ƒæ¨¡å‹
â”‚   â”œâ”€â”€ logs/               # è®­ç»ƒæ—¥å¿—
â”‚   â””â”€â”€ figures/            # å¯è§†åŒ–å›¾è¡¨
â”œâ”€â”€ docs/                    # æ–‡æ¡£
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â”œâ”€â”€ environment.yml         # Condaç¯å¢ƒé…ç½®
â””â”€â”€ pyproject.toml          # é¡¹ç›®é…ç½®
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå®‰è£…

```bash
# åˆ›å»ºcondaç¯å¢ƒ
conda env create -f environment.yml
conda activate rl-driving

# æˆ–ä½¿ç”¨pip
pip install -e .
```

### 2. è®­ç»ƒæ¨¡å‹

```bash
cd scripts
python train_multistage.py --stage 1 --n-envs 24 --timesteps 1000000
```

### 3. è¯„ä¼°æ¨¡å‹

```bash
python evaluate_local.py --stage 1 --n-episodes 100
```

### 4. å¯è§†åŒ–ç»“æœ

```bash
python visualize_local.py --stage 1
```

## ğŸ“Š è®­ç»ƒç»“æœ

### Stage 1 ç»“æœ

| æŒ‡æ ‡ | ç»“æœ |
|------|------|
| æˆåŠŸç‡ | 83.0% |
| ç¢°æ’ç‡ | 17.0% |
| å¹³å‡Reward | 73.19 |
| å¹³å‡Episodeé•¿åº¦ | 14.6æ­¥ |

## ğŸ® ç¯å¢ƒè¯´æ˜

### äº¤å‰è·¯å£ç¯å¢ƒ

- **è§‚æµ‹ç©ºé—´**: 20è¾†è½¦çš„ä½ç½®ã€é€Ÿåº¦ã€æ–¹å‘ä¿¡æ¯
- **åŠ¨ä½œç©ºé—´**: ç¦»æ•£åŠ¨ä½œï¼ˆåŠ é€Ÿã€å‡é€Ÿã€å·¦è½¬ã€å³è½¬ç­‰ï¼‰
- **ä»»åŠ¡**: 12ç§åœºæ™¯ï¼ˆå·¦è½¬ã€ç›´è¡Œã€å³è½¬ Ã— 4ä¸ªæ–¹å‘ï¼‰
- **å¥–åŠ±å‡½æ•°**: 9å¤§å¯†é›†å¥–åŠ±ç»„ä»¶
  - è·ç¦»å¥–åŠ±
  - è¿›åº¦å¥–åŠ±
  - æ–¹å‘å¥–åŠ±
  - è½¦é“å±…ä¸­å¥–åŠ±
  - å®‰å…¨è·ç¦»å¥–åŠ±
  - å¹³æ»‘é©¾é©¶å¥–åŠ±
  - åŠ¨æ€é€Ÿåº¦å¥–åŠ±
  - æ—¶é—´æƒ©ç½š
  - é«˜é€Ÿå¥–åŠ±

## ğŸ“ˆ è®­ç»ƒæŠ€å·§

1. **å¹¶è¡Œç¯å¢ƒ**: ä½¿ç”¨24ä¸ªå¹¶è¡Œç¯å¢ƒåŠ é€Ÿè®­ç»ƒ
2. **è¯„ä¼°å›è°ƒ**: æ¯5000æ­¥è¯„ä¼°ä¸€æ¬¡
3. **Checkpoint**: æ¯10000æ­¥ä¿å­˜ä¸€æ¬¡æ¨¡å‹
4. **Tensorboard**: å®æ—¶ç›‘æ§è®­ç»ƒè¿›åº¦

```bash
tensorboard --logdir ../outputs/logs --reload_interval 5
```

## ğŸ”§ æŠ€æœ¯æ ˆ

- **å¼ºåŒ–å­¦ä¹ æ¡†æ¶**: Stable-Baselines3 (PPO)
- **ç¯å¢ƒ**: Highway-env
- **å¯è§†åŒ–**: Matplotlib, Tensorboard
- **Python**: 3.10+

## ğŸ“ å¼€å‘æ—¥å¿—

### å·²å®Œæˆ
- âœ… åŸºç¡€ç¯å¢ƒæ­å»º
- âœ… å¯†é›†å¥–åŠ±ç³»ç»Ÿè®¾è®¡
- âœ… å¤šä»»åŠ¡åœºæ™¯å®ç°
- âœ… è®­ç»ƒæµç¨‹ä¼˜åŒ–
- âœ… è¯„ä¼°å’Œå¯è§†åŒ–å·¥å…·

### æœªæ¥è®¡åˆ’
- ğŸ”² æ›´å¤šè½¦è¾†åœºæ™¯
- ğŸ”² å¤æ‚è·¯å£å¸ƒå±€
- ğŸ”² çº¢ç»¿ç¯ç³»ç»Ÿï¼ˆå¸¦è§‚æµ‹ï¼‰
- ğŸ”² è¡Œäººç³»ç»Ÿï¼ˆå¸¦è§‚æµ‹ï¼‰
- ğŸ”² è¿ç»­ä¸¤ä¸ªè·¯å£

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æå‡ºIssueå’ŒPull Requestï¼

## ğŸ“„ License

MIT License

## ğŸ™ è‡´è°¢

- Highway-env: https://github.com/Farama-Foundation/HighwayEnv
- Stable-Baselines3: https://github.com/DLR-RM/stable-baselines3

---

**é¡¹ç›®ä½œè€…**: [ä½ çš„åå­—]
**è”ç³»æ–¹å¼**: [ä½ çš„é‚®ç®±]
